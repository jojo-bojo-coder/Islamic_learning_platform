{% extends base_template %}
{% load static %}

{% block title %}أحداث {{ date }} - {{ program.name }}{% endblock %}

{% block page_title %}أحداث {{ date|date:"Y-m-d" }} - {{ program.name }}{% endblock %}

{% block head %}

{% endblock %}

{% block content %}
<style>
    :root {
        --primary-color: #366092;
        --primary-gradient: linear-gradient(135deg, #366092, #2a4a7a);
        --secondary-color: #86B817;
        --danger-color: #DC2626;
        --success-color: #10B981;
        --warning-color: #F59E0B;
        --info-color: #3B82F6;
        --text-color: #374151;
        --text-light: #6B7280;
        --white: #FFFFFF;
        --light-bg: #F9FAFB;
        --border-color: #E5E7EB;
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        --border-radius: 10px;
        --border-radius-lg: 12px;
        --border-radius-xl: 16px;
    }

    /* Add recurrence badge styling */
    .recurrence-badge {
        background: linear-gradient(135deg, #6f42c1, #9b72cf);
        color: white;
        padding: 3px 10px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 3px;
        margin-left: 8px;
        box-shadow: 0 2px 4px rgba(111, 66, 193, 0.3);
    }

    .recurrence-days-badge {
        background: linear-gradient(135deg, #20c997, #3dd9a3);
        color: white;
        padding: 2px 8px;
        border-radius: 15px;
        font-size: 0.7rem;
        font-weight: 500;
        margin-left: 5px;
    }

    /* Priority badges */
    .priority-badge {
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 3px;
        margin-left: 8px;
    }

    .priority-high {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
        color: white;
    }

    .priority-medium {
        background: linear-gradient(135deg, #f39c12, #d68910);
        color: white;
    }

    .priority-low {
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
    }

    /* Overdue indicator */
    .overdue-indicator {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
        color: white;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 3px;
        margin-left: 8px;
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }

    .events-container {
        background: var(--white);
        border-radius: var(--border-radius-xl);
        padding: 2rem;
        box-shadow: var(--shadow-lg);
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
    }

    .events-container::before {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        width: 200px;
        height: 200px;
        background: radial-gradient(circle at top right, rgba(54, 96, 146, 0.1) 0%, transparent 70%);
        pointer-events: none;
    }

    .events-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 2px solid var(--border-color);
        flex-wrap: wrap;
        gap: 1rem;
    }

    .events-header h1 {
        font-family: 'Cairo', sans-serif;
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--primary-color);
        margin: 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .events-header h1 i {
        font-size: 1.6rem;
        color: var(--primary-color);
    }

    .btn {
        padding: 0.6rem 1.2rem;
        border-radius: var(--border-radius);
        font-weight: 600;
        font-size: 0.9375rem;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        border: none;
        cursor: pointer;
        font-family: 'Cairo', sans-serif;
    }

    .btn-secondary {
        background: var(--light-bg);
        color: var(--text-color);
        border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
        background: var(--white);
        border-color: var(--primary-color);
        color: var(--primary-color);
        transform: translateY(-1px);
    }

    .date-header {
        background: var(--primary-gradient);
        color: var(--white);
        padding: 1.5rem 2rem;
        border-radius: var(--border-radius-lg);
        margin-bottom: 2rem;
        text-align: center;
        box-shadow: var(--shadow-md);
        position: relative;
        overflow: hidden;
    }

    .date-header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transform: translateX(-100%);
    }

    .date-header h3 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 700;
        font-family: 'Cairo', sans-serif;
        position: relative;
        z-index: 1;
    }

    .hijri-date {
        display: block;
        font-size: 1rem;
        opacity: 0.9;
        margin-top: 0.5rem;
        direction: ltr;
        text-align: left;
    }

    .filters-section {
        background: var(--light-bg);
        border-radius: var(--border-radius-lg);
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: 1px solid var(--border-color);
    }

    .filters-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 1rem;
        font-family: 'Cairo', sans-serif;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .filters-title i {
        color: var(--primary-color);
    }

    .filters-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }

    .filter-btn {
        padding: 0.6rem 1rem;
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        background: var(--white);
        color: var(--text-color);
        font-weight: 500;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.4rem;
        font-family: 'Cairo', sans-serif;
    }

    .filter-btn:hover {
        border-color: var(--primary-color);
        color: var(--primary-color);
        transform: translateY(-1px);
    }

    .filter-btn.active {
        background: var(--primary-gradient);
        border-color: var(--primary-color);
        color: var(--white);
        box-shadow: var(--shadow-sm);
    }

    .filter-count {
        background: rgba(255, 255, 255, 0.2);
        padding: 0.2rem 0.5rem;
        border-radius: 10px;
        font-size: 0.75rem;
        font-weight: 600;
    }

    .filter-btn:not(.active) .filter-count {
        background: var(--light-bg);
        color: var(--text-light);
    }

    .section-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 1.5rem;
        padding-bottom: 0.8rem;
        border-bottom: 2px solid var(--border-color);
        font-family: 'Cairo', sans-serif;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .section-title i {
        font-size: 1.2rem;
    }

    .events-grid {
        display: grid;
        gap: 1.2rem;
        margin-bottom: 2.5rem;
    }

    .event-card {
        background: var(--white);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: 1.5rem;
        transition: all 0.3s ease;
        text-decoration: none;
        color: inherit;
        display: block;
        position: relative;
        overflow: hidden;
    }

    .event-card.recurring-task {
        border-left: 4px solid #6f42c1;
        border-right: none;
    }

    .event-card.recurring-task::before {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        width: 4px;
        height: 100%;
        background: #6f42c1;
    }

    .event-card::before {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        width: 4px;
        height: 100%;
        background: var(--primary-color);
    }

    .event-card:hover {
        border-color: var(--primary-color);
        box-shadow: var(--shadow-md);
        transform: translateY(-3px);
        color: inherit;
    }

    .event-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
        gap: 1rem;
    }

    .event-title-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .event-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--text-color);
        margin: 0;
        font-family: 'Cairo', sans-serif;
        line-height: 1.4;
    }

    .event-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
    }

    .event-type {
        color: var(--white);
        padding: 0.4rem 0.8rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.3rem;
        box-shadow: var(--shadow-sm);
        margin-right: 0.5rem;
        flex-shrink: 0;
    }

    .event-details {
        display: flex;
        flex-wrap: wrap;
        gap: 0.8rem;
        margin-bottom: 1rem;
    }

    .event-detail {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.85rem;
        color: var(--text-light);
        font-weight: 500;
        padding: 0.4rem 0.8rem;
        background: var(--light-bg);
        border-radius: 6px;
        border: 1px solid var(--border-color);
    }

    .event-detail i {
        color: var(--primary-color);
        width: 14px;
        font-size: 0.9rem;
    }

    .event-description {
        color: var(--text-color);
        line-height: 1.6;
        margin: 0;
        font-size: 0.95rem;
        opacity: 0.9;
    }

    .completion-progress {
        margin-top: 1rem;
        padding: 0.75rem;
        background: var(--light-bg);
        border-radius: var(--border-radius);
        border: 1px solid var(--border-color);
    }

    .progress-label {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
        color: var(--text-color);
        font-weight: 500;
    }

    .progress-bar-container {
        height: 10px;
        background: #e0e0e0;
        border-radius: 5px;
        overflow: hidden;
    }

    .progress-bar {
        height: 100%;
        background: linear-gradient(135deg, var(--success-color), #27ae60);
        border-radius: 5px;
        transition: width 0.3s ease;
    }

    .status-badge {
        padding: 0.4rem 0.8rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 0.3rem;
        margin-top: 1rem;
    }

    .status-badge.completed {
        background: rgba(39, 174, 96, 0.1);
        color: #27ae60;
        border: 1px solid rgba(39, 174, 96, 0.3);
    }

    .status-badge.upcoming {
        background: rgba(52, 152, 219, 0.1);
        color: #3498db;
        border: 1px solid rgba(52, 152, 219, 0.3);
    }

    .status-badge.past {
        background: rgba(231, 76, 60, 0.1);
        color: #e74c3c;
        border: 1px solid rgba(231, 76, 60, 0.3);
    }

    .status-badge.cancelled {
        background: rgba(108, 117, 125, 0.1);
        color: #6c757d;
        border: 1px solid rgba(108, 117, 125, 0.3);
    }

    .no-events {
        text-align: center;
        padding: 3rem 2rem;
        color: var(--text-light);
    }

    .no-events i {
        font-size: 3rem;
        margin-bottom: 1rem;
        color: var(--border-color);
    }

    .no-events h5 {
        font-weight: 600;
        color: var(--text-light);
        margin-bottom: 0.5rem;
        font-size: 1.1rem;
    }

    /* Hide sections by default - will be shown via JavaScript */
    .events-section {
        display: none;
    }

    .events-section.active {
        display: block;
    }

    /* Event type colors */
    .type-events { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
    .type-tasks { background: linear-gradient(135deg, #3498db, #2980b9); }
    .type-activities { background: linear-gradient(135deg, #27ae60, #229954); }
    .type-cultural_tasks { background: linear-gradient(135deg, #e67e22, #d35400); }
    .type-task_sessions { background: linear-gradient(135deg, #9C27B0, #7B1FA2); }
    .type-operations_tasks { background: linear-gradient(135deg, #16a085, #138d75); }
    .type-scientific_tasks { background: linear-gradient(135deg, #2c3e50, #34495e); }
    .type-lectures { background: linear-gradient(135deg, #8e44ad, #6c3483); }
    .type-sharia_tasks { background: linear-gradient(135deg, #c0392b, #922b21); }
    .type-family_competitions { background: linear-gradient(135deg, #d35400, #ba4a00); }
    .type-sports_tasks { background: linear-gradient(135deg, #f39c12, #d68910); }
    .type-matches { background: linear-gradient(135deg, #e74c3c, #c0392b); }

    /* Animation */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .fade-in-up {
        animation: fadeInUp 0.6s ease forwards;
    }

    /* Responsive Design */
    @media (max-width: 991px) {
        .events-container {
            padding: 1.5rem;
        }

        .events-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
        }

        .filters-grid {
            justify-content: center;
        }

        .date-header h3 {
            font-size: 1.3rem;
        }

        .event-header {
            flex-direction: column;
            gap: 0.8rem;
            align-items: flex-start;
        }

        .event-type {
            align-self: flex-start;
        }

        .event-details {
            flex-direction: column;
            gap: 0.5rem;
        }
    }

    @media (max-width: 767px) {
        .events-container {
            padding: 1rem;
        }

        .date-header {
            padding: 1.2rem 1.5rem;
        }

        .date-header h3 {
            font-size: 1.1rem;
        }

        .filters-section {
            padding: 1rem;
        }

        .filter-btn {
            padding: 0.5rem 0.8rem;
            font-size: 0.8rem;
        }

        .section-title {
            font-size: 1.1rem;
        }

        .event-card {
            padding: 1.2rem;
        }

        .event-title {
            font-size: 1rem;
        }
    }

    @media (max-width: 575px) {
        .filters-grid {
            justify-content: center;
        }

        .filter-btn {
            flex: 1;
            min-width: 140px;
            justify-content: center;
        }

        .date-header {
            padding: 1rem;
        }

        .hijri-date {
            font-size: 0.85rem;
        }
    }
    .event-card.recurring-task {
    border-left: 4px solid #6f42c1;
    border-right: none;
}

.event-card.recurring-task::before {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    width: 4px;
    height: 100%;
    background: #6f42c1;
}
</style>
<div class="events-container fade-in-up">
    <!-- Header -->
    <div class="events-header">
        <h1>
            <i class="fas fa-calendar-day"></i>
            أحداث اليوم
        </h1>
        <a href="{% url 'schedule_calendar' program.id %}?year={{ date.year }}&month={{ date.month }}" class="btn btn-secondary">
            <i class="fas fa-arrow-right"></i>
            العودة إلى الجدول
        </a>
    </div>

    <!-- Date Header -->
    <div class="date-header">
        <h3>
            <i class="fas fa-calendar-alt"></i>
            {{ date|date:"Y-m-d" }}
            <span class="hijri-date" data-date="{{ date|date:'Y-m-d' }}">
                <!-- Hijri date will be populated by JavaScript -->
            </span>
        </h3>
    </div>

    <!-- Filters -->
    <div class="filters-section">
        <div class="filters-title">
            <i class="fas fa-filter"></i>
            تصفية المحتوى
        </div>
        <div class="filters-grid">
            <button class="filter-btn active" data-filter="all">
                <i class="fas fa-layer-group"></i>
                الكل
                <span class="filter-count">{{ events.count|add:tasks_count|add:activities.count|add:cultural_tasks_count|add:task_sessions.count|add:operations_tasks_count|add:scientific_tasks_count|add:lectures.count|add:sharia_tasks_count|add:family_competitions.count|add:sports_tasks_count|add:matches.count }}</span>
            </button>
            <button class="filter-btn" data-filter="events">
                <i class="fas fa-calendar-check"></i>
                الأحداث
                <span class="filter-count">{{ events.count }}</span>
            </button>
            <button class="filter-btn" data-filter="tasks">
                <i class="fas fa-tasks"></i>
                المهام
                <span class="filter-count">{{ tasks_count }}</span>
            </button>
            <button class="filter-btn" data-filter="activities">
                <i class="fas fa-running"></i>
                الأنشطة
                <span class="filter-count">{{ activities.count }}</span>
            </button>
            <button class="filter-btn" data-filter="cultural_tasks">
                <i class="fas fa-theater-masks"></i>
                المهام الثقافية
                <span class="filter-count">{{ cultural_tasks_count }}</span>
            </button>
            <button class="filter-btn" data-filter="task_sessions">
                <i class="fas fa-clock"></i>
                جلسات المهام
                <span class="filter-count">{{ task_sessions.count }}</span>
            </button>
            <button class="filter-btn" data-filter="operations_tasks">
                <i class="fas fa-cogs"></i>
                المهام التشغيلية
                <span class="filter-count">{{ operations_tasks_count }}</span>
            </button>
            <button class="filter-btn" data-filter="scientific_tasks">
                <i class="fas fa-flask"></i>
                المهام العلمية
                <span class="filter-count">{{ scientific_tasks_count }}</span>
            </button>
            <button class="filter-btn" data-filter="lectures">
                <i class="fas fa-chalkboard-teacher"></i>
                المحاضرات
                <span class="filter-count">{{ lectures.count }}</span>
            </button>
            <button class="filter-btn" data-filter="sharia_tasks">
                <i class="fas fa-mosque"></i>
                المهام الشرعية
                <span class="filter-count">{{ sharia_tasks_count }}</span>
            </button>
            <button class="filter-btn" data-filter="family_competitions">
                <i class="fas fa-trophy"></i>
                المسابقات الأسرية
                <span class="filter-count">{{ family_competitions.count }}</span>
            </button>
            <button class="filter-btn" data-filter="sports_tasks">
                <i class="fas fa-futbol"></i>
                المهام الرياضية
                <span class="filter-count">{{ sports_tasks_count  }}</span>
            </button>
            <button class="filter-btn" data-filter="matches">
                <i class="fas fa-trophy"></i>
                المباريات
                <span class="filter-count">{{ matches.count }}</span>
            </button>
        </div>
    </div>

    <!-- Schedule Events -->
    <div class="events-section active" id="events-section">
        <h4 class="section-title">
            <i class="fas fa-calendar-check"></i>
            الأحداث المجدولة
        </h4>
        <div class="events-grid">
            {% for event in events %}
            <a href="{% url 'event_detail' event.id %}" class="event-card">
                <div class="event-header">
                    <h5 class="event-title">{{ event.title }}</h5>
                    <span class="event-type type-events">
                        <i class="fas fa-calendar-check"></i>
                        {{ event.get_event_type_display }}
                    </span>
                </div>
                <div class="event-details">
                    {% if event.start_time %}
                    <div class="event-detail">
                        <i class="fas fa-clock"></i>
                        <span>{{ event.start_time|time:"H:i" }}{% if event.end_time %} - {{ event.end_time|time:"H:i" }}{% endif %}</span>
                    </div>
                    {% endif %}
                    {% if event.location %}
                    <div class="event-detail">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>{{ event.location }}</span>
                    </div>
                    {% endif %}
                    {% if event.assigned_to %}
                    <div class="event-detail">
                        <i class="fas fa-user"></i>
                        <span>{{ event.assigned_to.get_full_name }}</span>
                    </div>
                    {% endif %}
                </div>
                {% if event.description %}
                <p class="event-description">{{ event.description|truncatewords:20 }}</p>
                {% endif %}
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-calendar-times"></i>
                <h5>لا توجد أحداث مجدولة</h5>
                <p>لم يتم جدولة أي أحداث لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Tasks -->
    <div class="events-section active" id="tasks-section">
        <h4 class="section-title">
            <i class="fas fa-tasks"></i>
            المهام
        </h4>
        <div class="events-grid">
            {% for task in tasks %}
            <a href="{% url 'object_detail' 'task' task.id %}" class="event-card {% if task.is_recurring %}recurring-task{% endif %}">
                <div class="event-header">
                    <div class="event-title-container">
                        <h5 class="event-title">{{ task.title }}</h5>
                        <div class="event-badges">
                            <span class="event-type type-tasks">
                                <i class="fas fa-tasks"></i>
                                مهمة
                            </span>
                            {% if task.is_recurring %}
                            <span class="recurrence-badge">
                                <i class="fas fa-redo"></i>
                                {{ task.get_recurrence_pattern_display }}
                            </span>
                            {% endif %}
                            {% if task.priority %}
                            <span class="priority-badge priority-{{ task.priority }}">
                                <i class="fas fa-flag"></i>
                                {{ task.get_priority_display }}
                            </span>
                            {% endif %}
                            {% if task.is_overdue %}
                            <span class="overdue-indicator">
                                <i class="fas fa-exclamation-triangle"></i>
                                متأخرة
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="event-details">
                    {% if task.committee %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ task.committee.name }}</span>
                    </div>
                    {% endif %}
                    {% if task.assigned_to %}
                    <div class="event-detail">
                        <i class="fas fa-user"></i>
                        <span>{{ task.assigned_to.get_full_name }}</span>
                    </div>
                    {% endif %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-day"></i>
                        <span>تاريخ الاستحقاق: {{ task.due_date|date:"Y/m/d" }}</span>
                    </div>
                    {% if task.is_recurring %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-alt"></i>
                        <span>نشطة منذ: {{ task.start_date|date:"Y/m/d" }}</span>
                    </div>
                    {% if task.recurrence_end_date %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-times"></i>
                        <span>تنتهي في: {{ task.recurrence_end_date|date:"Y/m/d" }}</span>
                    </div>
                    {% endif %}
                    {% endif %}
                </div>
                {% if task.description %}
                <p class="event-description">{{ task.description|truncatewords:30 }}</p>
                {% endif %}
                {% if task.completion_percentage > 0 %}
                <div class="completion-progress">
                    <div class="progress-label">
                        <span>نسبة الإنجاز</span>
                        <span>{{ task.completion_percentage }}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: {{ task.completion_percentage }}%"></div>
                    </div>
                </div>
                {% endif %}
                <div class="status-badge {% if task.status == 'completed' %}completed{% elif task.status == 'overdue' %}past{% else %}upcoming{% endif %}">
                    {% if task.status == 'completed' %}
                    <i class="fas fa-check-circle"></i> مكتملة
                    {% elif task.status == 'overdue' %}
                    <i class="fas fa-exclamation-circle"></i> متأخرة
                    {% else %}
                    <i class="fas fa-clock"></i> {{ task.get_status_display }}
                    {% endif %}
                </div>
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-tasks"></i>
                <h5>لا توجد مهام</h5>
                <p>لم يتم إضافة أي مهام لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Activities -->
    <div class="events-section active" id="activities-section">
        <h4 class="section-title">
            <i class="fas fa-running"></i>
            الأنشطة
        </h4>
        <div class="events-grid">
            {% for activity in activities %}
            <a href="{% url 'object_detail' 'activity' activity.id %}" class="event-card">
                <div class="event-header">
                    <h5 class="event-title">{{ activity.name }}</h5>
                    <span class="event-type type-activities">
                        <i class="fas fa-running"></i>
                        نشاط
                    </span>
                </div>
                <div class="event-details">
                    {% if activity.committee %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ activity.committee.name }}</span>
                    </div>
                    {% endif %}
                    {% if activity.location %}
                    <div class="event-detail">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>{{ activity.location }}</span>
                    </div>
                    {% endif %}
                    {% if activity.time %}
                    <div class="event-detail">
                        <i class="fas fa-clock"></i>
                        <span>{{ activity.time|time:"H:i" }}</span>
                    </div>
                    {% endif %}
                </div>
                {% if activity.description %}
                <p class="event-description">{{ activity.description|truncatewords:20 }}</p>
                {% endif %}
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-running"></i>
                <h5>لا توجد أنشطة</h5>
                <p>لم يتم إضافة أي أنشطة لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Cultural Tasks -->
    <div class="events-section active" id="cultural_tasks-section">
        <h4 class="section-title">
            <i class="fas fa-theater-masks"></i>
            المهام الثقافية
        </h4>
        <div class="events-grid">
            {% for cultural_task in cultural_tasks %}
            <a href="{% url 'object_detail' 'cultural_task' cultural_task.id %}" class="event-card {% if cultural_task.is_recurring %}recurring-task{% endif %}">
                <div class="event-header">
                    <div class="event-title-container">
                        <h5 class="event-title">{{ cultural_task.title }}</h5>
                        <div class="event-badges">
                            <span class="event-type type-cultural_tasks">
                                <i class="fas fa-theater-masks"></i>
                                مهمة ثقافية
                            </span>
                            {% if cultural_task.is_recurring %}
                            <span class="recurrence-badge">
                                <i class="fas fa-redo"></i>
                                {{ cultural_task.get_recurrence_pattern_display }}
                            </span>
                            {% endif %}
                            {% if cultural_task.priority %}
                            <span class="priority-badge priority-{{ cultural_task.priority }}">
                                <i class="fas fa-flag"></i>
                                {{ cultural_task.get_priority_display }}
                            </span>
                            {% endif %}
                            {% if cultural_task.is_overdue %}
                            <span class="overdue-indicator">
                                <i class="fas fa-exclamation-triangle"></i>
                                متأخرة
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="event-details">
                    {% if cultural_task.committee %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ cultural_task.committee.name }}</span>
                    </div>
                    {% endif %}
                    {% if cultural_task.assigned_to_name %}
                    <div class="event-detail">
                        <i class="fas fa-user"></i>
                        <span>{{ cultural_task.assigned_to_name }}</span>
                    </div>
                    {% endif %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-day"></i>
                        <span>تاريخ الاستحقاق: {{ cultural_task.due_date|date:"Y/m/d" }}</span>
                    </div>
                    {% if cultural_task.is_recurring %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-alt"></i>
                        <span>نشطة منذ: {{ cultural_task.start_date|date:"Y/m/d" }}</span>
                    </div>
                    {% if cultural_task.recurrence_end_date %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-times"></i>
                        <span>تنتهي في: {{ cultural_task.recurrence_end_date|date:"Y/m/d" }}</span>
                    </div>
                    {% endif %}
                    {% endif %}
                    <div class="event-detail">
                        <i class="fas fa-tag"></i>
                        <span>نوع المهمة: {{ cultural_task.get_task_type_display }}</span>
                    </div>
                </div>
                {% if cultural_task.description %}
                <p class="event-description">{{ cultural_task.description|truncatewords:30 }}</p>
                {% endif %}
                {% if cultural_task.completion_percentage > 0 %}
                <div class="completion-progress">
                    <div class="progress-label">
                        <span>نسبة الإنجاز</span>
                        <span>{{ cultural_task.completion_percentage }}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: {{ cultural_task.completion_percentage }}%"></div>
                    </div>
                </div>
                {% endif %}
                {% if cultural_task.has_sessions %}
                <div class="event-detail">
                    <i class="fas fa-clock"></i>
                    <span>تحتوي على {{ cultural_task.sessions_count }} جلسة</span>
                </div>
                {% endif %}
                <div class="status-badge
                    {% if cultural_task.status == 'completed' %}completed
                    {% elif cultural_task.status == 'cancelled' %}cancelled
                    {% else %}upcoming{% endif %}">
                    {% if cultural_task.status == 'completed' %}
                    <i class="fas fa-check-circle"></i> مكتملة
                    {% elif cultural_task.status == 'cancelled' %}
                    <i class="fas fa-times-circle"></i> ملغاة
                    {% else %}
                    <i class="fas fa-clock"></i> {{ cultural_task.get_status_display }}
                    {% endif %}
                </div>
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-theater-masks"></i>
                <h5>لا توجد مهام ثقافية</h5>
                <p>لم يتم إضافة أي مهام ثقافية لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Task Sessions -->
    <div class="events-section active" id="task_sessions-section">
        <h4 class="section-title">
            <i class="fas fa-clock"></i>
            جلسات المهام الثقافية
        </h4>
        <div class="events-grid">
            {% for session in task_sessions %}
            <a href="{% url 'object_detail' 'cultural_task' session.task.id %}" class="event-card">
                <div class="event-header">
                    <h5 class="event-title">{{ session.name }}</h5>
                    <span class="event-type type-task_sessions">
                        <i class="fas fa-clock"></i>
                        جلسة مهمة
                    </span>
                </div>
                <div class="event-details">
                    <div class="event-detail">
                        <i class="fas fa-calendar"></i>
                        <span>{{ session.date|date:"Y/m/d" }}</span>
                    </div>
                    <div class="event-detail">
                        <i class="fas fa-clock"></i>
                        <span>{{ session.time|time:"H:i" }}</span>
                    </div>
                    <div class="event-detail">
                        <i class="fas fa-tasks"></i>
                        <span>{{ session.task.title }}</span>
                    </div>
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ session.task.committee.name }}</span>
                    </div>
                </div>
                {% if session.notes %}
                <p class="event-description">{{ session.notes|truncatewords:20 }}</p>
                {% endif %}
                <div class="status-badge {% if session.is_completed %}completed{% elif session.is_past %}past{% else %}upcoming{% endif %}">
                    {% if session.is_completed %}
                    <i class="fas fa-check-circle"></i> مكتملة
                    {% elif session.is_past %}
                    <i class="fas fa-exclamation-circle"></i> منتهية
                    {% else %}
                    <i class="fas fa-clock"></i> قادمة
                    {% endif %}
                </div>
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-clock"></i>
                <h5>لا توجد جلسات مهام</h5>
                <p>لم يتم إضافة أي جلسات مهام لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Operations Tasks -->
    <div class="events-section active" id="operations_tasks-section">
    <h4 class="section-title">
        <i class="fas fa-cogs"></i>
        المهام التشغيلية
    </h4>
    <div class="events-grid">
        {% for operations_task in operations_tasks %}
        <a href="{% url 'object_detail' 'operations_task' operations_task.id %}" class="event-card {% if operations_task.is_recurring %}recurring-task{% endif %}">
            <div class="event-header">
                <div class="event-title-container">
                    <h5 class="event-title">{{ operations_task.title }}</h5>
                    <div class="event-badges">
                        <span class="event-type type-operations_tasks">
                            <i class="fas fa-cogs"></i>
                            مهمة تشغيلية
                        </span>
                        {% if operations_task.is_recurring %}
                        <span class="recurrence-badge">
                            <i class="fas fa-redo"></i>
                            {{ operations_task.get_recurrence_pattern_display }}
                        </span>
                        {% endif %}
                        {% if operations_task.priority %}
                        <span class="priority-badge priority-{{ operations_task.priority }}">
                            <i class="fas fa-flag"></i>
                            {{ operations_task.get_priority_display }}
                        </span>
                        {% endif %}
                        {% if operations_task.is_overdue %}
                        <span class="overdue-indicator">
                            <i class="fas fa-exclamation-triangle"></i>
                            متأخرة
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="event-details">
                {% if operations_task.committee %}
                <div class="event-detail">
                    <i class="fas fa-users"></i>
                    <span>{{ operations_task.committee.name }}</span>
                </div>
                {% endif %}
                {% if operations_task.assigned_to_name %}
                <div class="event-detail">
                    <i class="fas fa-user"></i>
                    <span>{{ operations_task.assigned_to_name }}</span>
                </div>
                {% endif %}
                <div class="event-detail">
                    <i class="fas fa-calendar-day"></i>
                    <span>تاريخ الاستحقاق: {{ operations_task.due_date|date:"Y/m/d" }}</span>
                </div>
                {% if operations_task.is_recurring %}
                <div class="event-detail">
                    <i class="fas fa-calendar-alt"></i>
                    <span>نشطة منذ: {{ operations_task.start_date|date:"Y/m/d" }}</span>
                </div>
                {% if operations_task.recurrence_end_date %}
                <div class="event-detail">
                    <i class="fas fa-calendar-times"></i>
                    <span>تنتهي في: {{ operations_task.recurrence_end_date|date:"Y/m/d" }}</span>
                </div>
                {% endif %}
                {% endif %}
                {% if operations_task.task_type %}
                <div class="event-detail">
                    <i class="fas fa-tag"></i>
                    <span>نوع المهمة: {{ operations_task.get_task_type_display }}</span>
                </div>
                {% endif %}
            </div>
            {% if operations_task.description %}
            <p class="event-description">{{ operations_task.description|truncatewords:30 }}</p>
            {% endif %}
            {% if operations_task.completion_percentage > 0 %}
            <div class="completion-progress">
                <div class="progress-label">
                    <span>نسبة الإنجاز</span>
                    <span>{{ operations_task.completion_percentage }}%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" style="width: {{ operations_task.completion_percentage }}%"></div>
                </div>
            </div>
            {% endif %}
            <div class="status-badge
                {% if operations_task.status == 'completed' %}completed
                {% elif operations_task.status == 'overdue' %}past
                {% else %}upcoming{% endif %}">
                {% if operations_task.status == 'completed' %}
                <i class="fas fa-check-circle"></i> مكتملة
                {% elif operations_task.status == 'overdue' %}
                <i class="fas fa-exclamation-circle"></i> متأخرة
                {% else %}
                <i class="fas fa-clock"></i> {{ operations_task.get_status_display }}
                {% endif %}
            </div>
        </a>
        {% empty %}
        <div class="no-events">
            <i class="fas fa-cogs"></i>
            <h5>لا توجد مهام تشغيلية</h5>
            <p>لم يتم إضافة أي مهام تشغيلية لهذا اليوم</p>
        </div>
        {% endfor %}
    </div>
</div>

    <!-- Scientific Tasks -->
    <div class="events-section active" id="scientific_tasks-section">
    <h4 class="section-title">
        <i class="fas fa-flask"></i>
        المهام العلمية
    </h4>
    <div class="events-grid">
        {% for scientific_task in scientific_tasks %}
        <a href="{% url 'object_detail' 'scientific_task' scientific_task.id %}" class="event-card {% if scientific_task.is_recurring %}recurring-task{% endif %}">
            <div class="event-header">
                <div class="event-title-container">
                    <h5 class="event-title">{{ scientific_task.title }}</h5>
                    <div class="event-badges">
                        <span class="event-type type-scientific_tasks">
                            <i class="fas fa-flask"></i>
                            مهمة علمية
                        </span>
                        {% if scientific_task.is_recurring %}
                        <span class="recurrence-badge">
                            <i class="fas fa-redo"></i>
                            {{ scientific_task.get_recurrence_pattern_display }}
                        </span>
                        {% endif %}
                        {% if scientific_task.priority %}
                        <span class="priority-badge priority-{{ scientific_task.priority }}">
                            <i class="fas fa-flag"></i>
                            {{ scientific_task.get_priority_display }}
                        </span>
                        {% endif %}
                        {% if scientific_task.is_overdue %}
                        <span class="overdue-indicator">
                            <i class="fas fa-exclamation-triangle"></i>
                            متأخرة
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="event-details">
                {% if scientific_task.committee %}
                <div class="event-detail">
                    <i class="fas fa-users"></i>
                    <span>{{ scientific_task.committee.name }}</span>
                </div>
                {% endif %}
                {% if scientific_task.assigned_to_name %}
                <div class="event-detail">
                    <i class="fas fa-user"></i>
                    <span>{{ scientific_task.assigned_to_name }}</span>
                </div>
                {% endif %}
                <div class="event-detail">
                    <i class="fas fa-calendar-day"></i>
                    <span>تاريخ الاستحقاق: {{ scientific_task.due_date|date:"Y/m/d" }}</span>
                </div>
                {% if scientific_task.is_recurring %}
                <div class="event-detail">
                    <i class="fas fa-calendar-alt"></i>
                    <span>نشطة منذ: {{ scientific_task.start_date|date:"Y/m/d" }}</span>
                </div>
                {% if scientific_task.recurrence_end_date %}
                <div class="event-detail">
                    <i class="fas fa-calendar-times"></i>
                    <span>تنتهي في: {{ scientific_task.recurrence_end_date|date:"Y/m/d" }}</span>
                </div>
                {% endif %}
                {% endif %}
                {% if scientific_task.task_type %}
                <div class="event-detail">
                    <i class="fas fa-tag"></i>
                    <span>نوع المهمة: {{ scientific_task.get_task_type_display }}</span>
                </div>
                {% endif %}
            </div>
            {% if scientific_task.description %}
            <p class="event-description">{{ scientific_task.description|truncatewords:30 }}</p>
            {% endif %}
            {% if scientific_task.completion_percentage > 0 %}
            <div class="completion-progress">
                <div class="progress-label">
                    <span>نسبة الإنجاز</span>
                    <span>{{ scientific_task.completion_percentage }}%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" style="width: {{ scientific_task.completion_percentage }}%"></div>
                </div>
            </div>
            {% endif %}
            <div class="status-badge
                {% if scientific_task.status == 'completed' %}completed
                {% elif scientific_task.status == 'cancelled' %}cancelled
                {% else %}upcoming{% endif %}">
                {% if scientific_task.status == 'completed' %}
                <i class="fas fa-check-circle"></i> مكتملة
                {% elif scientific_task.status == 'cancelled' %}
                <i class="fas fa-times-circle"></i> ملغاة
                {% else %}
                <i class="fas fa-clock"></i> {{ scientific_task.get_status_display }}
                {% endif %}
            </div>
        </a>
        {% empty %}
        <div class="no-events">
            <i class="fas fa-flask"></i>
            <h5>لا توجد مهام علمية</h5>
            <p>لم يتم إضافة أي مهام علمية لهذا اليوم</p>
        </div>
        {% endfor %}
    </div>
</div>

    <!-- Lectures -->
    <div class="events-section active" id="lectures-section">
        <h4 class="section-title">
            <i class="fas fa-chalkboard-teacher"></i>
            المحاضرات
        </h4>
        <div class="events-grid">
            {% for lecture in lectures %}
            <a href="{% url 'object_detail' 'lecture' lecture.id %}" class="event-card">
                <div class="event-header">
                    <h5 class="event-title">{{ lecture.title }}</h5>
                    <span class="event-type type-lectures">
                        <i class="fas fa-chalkboard-teacher"></i>
                        محاضرة
                    </span>
                </div>
                <div class="event-details">
                    {% if lecture.committee %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ lecture.committee.name }}</span>
                    </div>
                    {% endif %}
                    {% if lecture.time %}
                    <div class="event-detail">
                        <i class="fas fa-clock"></i>
                        <span>{{ lecture.time|time:"H:i" }}</span>
                    </div>
                    {% endif %}
                    {% if lecture.location %}
                    <div class="event-detail">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>{{ lecture.location }}</span>
                    </div>
                    {% endif %}
                </div>
                {% if lecture.description %}
                <p class="event-description">{{ lecture.description|truncatewords:20 }}</p>
                {% endif %}
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-chalkboard-teacher"></i>
                <h5>لا توجد محاضرات</h5>
                <p>لم يتم إضافة أي محاضرات لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Sharia Tasks -->
    <div class="events-section active" id="sharia_tasks-section">
    <h4 class="section-title">
        <i class="fas fa-mosque"></i>
        المهام الشرعية
    </h4>
    <div class="events-grid">
        {% for sharia_task in sharia_tasks %}
        <a href="{% url 'object_detail' 'sharia_task' sharia_task.id %}" class="event-card {% if sharia_task.is_recurring %}recurring-task{% endif %}">
            <div class="event-header">
                <div class="event-title-container">
                    <h5 class="event-title">{{ sharia_task.title }}</h5>
                    <div class="event-badges">
                        <span class="event-type type-sharia_tasks">
                            <i class="fas fa-mosque"></i>
                            مهمة شرعية
                        </span>
                        {% if sharia_task.is_recurring %}
                        <span class="recurrence-badge">
                            <i class="fas fa-redo"></i>
                            {{ sharia_task.get_recurrence_pattern_display }}
                        </span>
                        {% endif %}
                        {% if sharia_task.is_overdue %}
                        <span class="overdue-indicator">
                            <i class="fas fa-exclamation-triangle"></i>
                            متأخرة
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="event-details">
                {% if sharia_task.committee %}
                <div class="event-detail">
                    <i class="fas fa-users"></i>
                    <span>{{ sharia_task.committee.name }}</span>
                </div>
                {% endif %}
                {% if sharia_task.assigned_to_name %}
                <div class="event-detail">
                    <i class="fas fa-user"></i>
                    <span>{{ sharia_task.assigned_to_name }}</span>
                </div>
                {% endif %}
                <div class="event-detail">
                    <i class="fas fa-calendar-day"></i>
                    <span>تاريخ الاستحقاق: {{ sharia_task.due_date|date:"Y/m/d" }}</span>
                </div>
                {% if sharia_task.is_recurring %}
                <div class="event-detail">
                    <i class="fas fa-calendar-alt"></i>
                    <span>نشطة منذ: {{ sharia_task.start_date|date:"Y/m/d" }}</span>
                </div>
                {% if sharia_task.recurrence_end_date %}
                <div class="event-detail">
                    <i class="fas fa-calendar-times"></i>
                    <span>تنتهي في: {{ sharia_task.recurrence_end_date|date:"Y/m/d" }}</span>
                </div>
                {% endif %}
                {% endif %}
                {% if sharia_task.task_type %}
                <div class="event-detail">
                    <i class="fas fa-tag"></i>
                    <span>نوع المهمة: {{ sharia_task.get_task_type_display }}</span>
                </div>
                {% endif %}
            </div>
            {% if sharia_task.description %}
            <p class="event-description">{{ sharia_task.description|truncatewords:30 }}</p>
            {% endif %}
            {% if sharia_task.completion_percentage > 0 %}
            <div class="completion-progress">
                <div class="progress-label">
                    <span>نسبة الإنجاز</span>
                    <span>{{ sharia_task.completion_percentage }}%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" style="width: {{ sharia_task.completion_percentage }}%"></div>
                </div>
            </div>
            {% endif %}
            <div class="status-badge
                {% if sharia_task.status == 'completed' %}completed
                {% elif sharia_task.status == 'cancelled' %}cancelled
                {% else %}upcoming{% endif %}">
                {% if sharia_task.status == 'completed' %}
                <i class="fas fa-check-circle"></i> مكتملة
                {% elif sharia_task.status == 'cancelled' %}
                <i class="fas fa-times-circle"></i> ملغاة
                {% else %}
                <i class="fas fa-clock"></i> {{ sharia_task.get_status_display }}
                {% endif %}
            </div>
        </a>
        {% empty %}
        <div class="no-events">
            <i class="fas fa-mosque"></i>
            <h5>لا توجد مهام شرعية</h5>
            <p>لم يتم إضافة أي مهام شرعية لهذا اليوم</p>
        </div>
        {% endfor %}
    </div>
</div>

    <!-- Family Competitions -->
    <div class="events-section active" id="family_competitions-section">
        <h4 class="section-title">
            <i class="fas fa-trophy"></i>
            المسابقات الأسرية
        </h4>
        <div class="events-grid">
            {% for competition in family_competitions %}
            <a href="{% url 'object_detail' 'family_competition' competition.id %}" class="event-card">
                <div class="event-header">
                    <h5 class="event-title">{{ competition.title }}</h5>
                    <span class="event-type type-family_competitions">
                        <i class="fas fa-trophy"></i>
                        مسابقة أسرية
                    </span>
                </div>
                <div class="event-details">
                    {% if competition.committee %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ competition.committee.name }}</span>
                    </div>
                    {% endif %}
                    <div class="event-detail">
                        <i class="fas fa-calendar"></i>
                        <span>{{ competition.start_date|date:"Y/m/d" }} - {{ competition.end_date|date:"Y/m/d" }}</span>
                    </div>
                </div>
                {% if competition.description %}
                <p class="event-description">{{ competition.description|truncatewords:20 }}</p>
                {% endif %}
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-trophy"></i>
                <h5>لا توجد مسابقات أسرية</h5>
                <p>لم يتم إضافة أي مسابقات أسرية لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Sports Tasks -->
    <div class="events-section active" id="sports_tasks-section">
        <h4 class="section-title">
            <i class="fas fa-futbol"></i>
            المهام الرياضية
        </h4>
        <div class="events-grid">
            {% for sports_task in sports_tasks %}
            <a href="{% url 'object_detail' 'sports_task' sports_task.id %}" class="event-card {% if sports_task.is_recurring %}recurring-task{% endif %}">
                <div class="event-header">
                    <div class="event-title-container">
                        <h5 class="event-title">{{ sports_task.title }}</h5>
                        <div class="event-badges">
                            <span class="event-type type-sports_tasks">
                                <i class="fas fa-futbol"></i>
                                مهمة رياضية
                            </span>
                            {% if sports_task.is_recurring %}
                            <span class="recurrence-badge">
                                <i class="fas fa-redo"></i>
                                {{ sports_task.get_recurrence_pattern_display }}
                            </span>
                            {% endif %}
                            {% if sports_task.priority %}
                            <span class="priority-badge priority-{{ sports_task.priority }}">
                                <i class="fas fa-flag"></i>
                                {{ sports_task.get_priority_display }}
                            </span>
                            {% endif %}
                            {% if sports_task.is_overdue %}
                            <span class="overdue-indicator">
                                <i class="fas fa-exclamation-triangle"></i>
                                متأخرة
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="event-details">
                    {% if sports_task.committee %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ sports_task.committee.name }}</span>
                    </div>
                    {% endif %}
                    {% if sports_task.assigned_to_name %}
                    <div class="event-detail">
                        <i class="fas fa-user"></i>
                        <span>{{ sports_task.assigned_to_name }}</span>
                    </div>
                    {% endif %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-day"></i>
                        <span>تاريخ الاستحقاق: {{ sports_task.due_date|date:"Y/m/d" }}</span>
                    </div>
                    {% if sports_task.is_recurring %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-alt"></i>
                        <span>نشطة منذ: {{ sports_task.start_date|date:"Y/m/d" }}</span>
                    </div>
                    {% if sports_task.recurrence_end_date %}
                    <div class="event-detail">
                        <i class="fas fa-calendar-times"></i>
                        <span>تنتهي في: {{ sports_task.recurrence_end_date|date:"Y/m/d" }}</span>
                    </div>
                    {% endif %}
                    {% endif %}
                    {% if sports_task.task_type %}
                    <div class="event-detail">
                        <i class="fas fa-tag"></i>
                        <span>نوع المهمة: {{ sports_task.get_task_type_display }}</span>
                    </div>
                    {% endif %}
                </div>
                {% if sports_task.description %}
                <p class="event-description">{{ sports_task.description|truncatewords:30 }}</p>
                {% endif %}
                {% if sports_task.completion_percentage > 0 %}
                <div class="completion-progress">
                    <div class="progress-label">
                        <span>نسبة الإنجاز</span>
                        <span>{{ sports_task.completion_percentage }}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: {{ sports_task.completion_percentage }}%"></div>
                    </div>
                </div>
                {% endif %}
                <div class="status-badge
                    {% if sports_task.status == 'completed' %}completed
                    {% elif sports_task.status == 'cancelled' %}cancelled
                    {% else %}upcoming{% endif %}">
                    {% if sports_task.status == 'completed' %}
                    <i class="fas fa-check-circle"></i> مكتملة
                    {% elif sports_task.status == 'cancelled' %}
                    <i class="fas fa-times-circle"></i> ملغاة
                    {% else %}
                    <i class="fas fa-clock"></i> {{ sports_task.get_status_display }}
                    {% endif %}
                </div>
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-futbol"></i>
                <h5>لا توجد مهام رياضية</h5>
                <p>لم يتم إضافة أي مهام رياضية لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Matches -->
    <div class="events-section active" id="matches-section">
        <h4 class="section-title">
            <i class="fas fa-trophy"></i>
            المباريات
        </h4>
        <div class="events-grid">
            {% for match in matches %}
            <a href="{% url 'object_detail' 'match' match.id %}" class="event-card">
                <div class="event-header">
                    <h5 class="event-title">{{ match.title }}</h5>
                    <span class="event-type type-matches">
                        <i class="fas fa-trophy"></i>
                        مباراة
                    </span>
                </div>
                <div class="event-details">
                    {% if match.committee %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ match.committee.name }}</span>
                    </div>
                    {% endif %}
                    {% if match.time %}
                    <div class="event-detail">
                        <i class="fas fa-clock"></i>
                        <span>{{ match.time|time:"H:i" }}</span>
                    </div>
                    {% endif %}
                    {% if match.location %}
                    <div class="event-detail">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>{{ match.location }}</span>
                    </div>
                    {% endif %}
                    <div class="event-detail">
                        <i class="fas fa-users"></i>
                        <span>{{ match.team1 }} vs {{ match.team2 }}</span>
                    </div>
                </div>
            </a>
            {% empty %}
            <div class="no-events">
                <i class="fas fa-trophy"></i>
                <h5>لا توجد مباريات</h5>
                <p>لم يتم إضافة أي مباريات لهذا اليوم</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Filter functionality
        const filterButtons = document.querySelectorAll('.filter-btn');
        const eventSections = document.querySelectorAll('.events-section');

        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                const filter = this.getAttribute('data-filter');

                // Update active button
                filterButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');

                // Show/hide sections based on filter
                eventSections.forEach(section => {
                    if (filter === 'all') {
                        section.classList.add('active');
                    } else {
                        if (section.id === `${filter}-section`) {
                            section.classList.add('active');
                        } else {
                            section.classList.remove('active');
                        }
                    }
                });
            });
        });

        // Hijri date conversion
        try {
            if (typeof moment !== 'undefined' && moment.hijri) {
                const hijriElement = document.querySelector('.hijri-date');
                if (hijriElement) {
                    const dateStr = hijriElement.getAttribute('data-date');
                    if (dateStr) {
                        const hijriDate = moment(dateStr).format('iYYYY/iM/iD');
                        hijriElement.textContent = hijriDate;
                    }
                }
            }
        } catch (e) {
            console.log('Moment Hijri not loaded, skipping Hijri conversion');
        }

        // Add hover effect to event cards
        const eventCards = document.querySelectorAll('.event-card');
        eventCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-3px)';
                this.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.1)';
            });
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.1)';
            });
        });
    });
</script>
{% endblock %}