{% extends 'base.html' %}
{% load static %}

{% block title %}الرئيسية - منصة التحفيظ والدروس الدينية{% endblock %}

{% block extra_css %}
<style>
    /* Hero Section - Split Design */
    .hero-section {
        min-height: 90vh;
        display: flex;
        align-items: center;
        background: var(--white);
        padding: 4rem 0;
    }

    .hero-content {
        display: flex;
        align-items: center;
        gap: 0;
    }

    .hero-left {
        flex: 1.6;
        padding-left: 3rem;
    }

    .hero-tag {
        display: inline-block;
        background: rgba(134, 184, 23, 0.1);
        color: var(--primary-green);
        padding: 8px 20px;
        border-radius: 50px;
        font-size: 0.9rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
    }

    .hero-title {
        font-family: 'Cairo', sans-serif;
        font-size: 3.5rem;
        font-weight: 800;
        color: var(--text-dark);
        line-height: 1.2;
        margin-bottom: 1.5rem;
    }

    .hero-title .highlight {
        color: var(--primary-green);
    }

    .hero-description {
        font-size: 1.1rem;
        color: var(--text-gray);
        line-height: 1.8;
        margin-bottom: 2.5rem;
        max-width: 600px;
    }

    .hero-actions {
        display: flex;
        gap: 1rem;
        align-items: center;
    }

    .hero-right {
        flex: 1;
        position: relative;
    }

    .hero-image-wrapper {
        position: relative;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
    }

    .hero-image-wrapper img {
        width: 100%;
        height: auto;
        display: block;
    }

    .hero-badge {
        position: absolute;
        background: var(--white);
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    }

    .hero-badge.top {
        top: 20px;
        right: 20px;
        text-align: center;
    }

    .hero-badge.bottom {
        bottom: 20px;
        right: 20px;
    }

    .rating-stars {
        color: #FFC107;
        font-size: 1.2rem;
        margin-bottom: 0.5rem;
    }

    .rating-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--text-dark);
    }

    .rating-text {
        font-size: 0.85rem;
        color: var(--text-gray);
        margin-top: 0.3rem;
    }

    .clients-info {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .client-avatars {
        display: flex;
    }

    .client-avatar {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        border: 2px solid var(--white);
        margin-right: -10px;
        background: var(--primary-green);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-weight: 600;
        font-size: 0.8rem;
    }

    .client-text {
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--text-dark);
    }

    /* Statistics Section */
    .stats-section {
        background: var(--light-bg);
        padding: 5rem 0;
    }

    .stat-card {
        background: var(--white);
        border-radius: 15px;
        padding: 2.5rem 2rem;
        text-align: center;
        transition: all 0.3s ease;
        border: 1px solid var(--border-light);
    }

    .stat-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    }

    .stat-number {
        font-size: 3rem;
        font-weight: 700;
        color: var(--primary-green);
        margin-bottom: 0.5rem;
    }

    .stat-label {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-dark);
    }

    .stat-card i {
        color: var(--primary-green);
        font-size: 2.5rem;
        margin-bottom: 1rem;
        opacity: 0.2;
    }

    /* Features Section */
    .features-section {
        padding: 6rem 0;
        background: url('./static/images/pexels-aqtai-2233416.jpg') no-repeat center center;
        background-size: cover;
    }

    .section-title {
        font-family: 'Cairo', sans-serif;
        font-size: 2.8rem;
        font-weight: 700;
        color: var(--text-dark);
        margin-bottom: 1rem;
        text-align: center;
    }

    .section-subtitle {
        font-size: 1.1rem;
        color: var(--text-gray);
        text-align: center;
        margin-bottom: 4rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
    }

    .feature-card {
        background: var(--white);
        border: 1px solid var(--border-light);
        border-radius: 15px;
        padding: 2.5rem;
        height: 100%;
        transition: all 0.3s ease;
    }

    .feature-card:hover {
        border-color: var(--primary-green);
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(134, 184, 23, 0.15);
    }

    .feature-icon {
        width: 70px;
        height: 70px;
        background: rgba(134, 184, 23, 0.1);
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1.5rem;
    }

    .feature-icon i {
        font-size: 2rem;
        color: var(--primary-green);
    }

    .feature-card h4 {
        font-family: 'Cairo', sans-serif;
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-dark);
        margin-bottom: 1rem;
    }

    .feature-card p {
        color: var(--text-gray);
        font-size: 1rem;
        line-height: 1.7;
    }

    /* Programs Section */
    .programs-section {
        padding: 6rem 0;
        background: var(--light-bg);
    }

    .program-card {
        background: var(--white);
        border-radius: 15px;
        padding: 2.5rem;
        border: 1px solid var(--border-light);
        height: 100%;
        transition: all 0.3s ease;
    }

    .program-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    }

    .program-card h4 {
        font-family: 'Cairo', sans-serif;
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--text-dark);
        margin-bottom: 1rem;
    }

    .program-card p {
        color: var(--text-gray);
        font-size: 1rem;
        line-height: 1.7;
        margin-bottom: 1.5rem;
    }

    .program-card ul {
        list-style: none;
        padding: 0;
    }

    .program-card li {
        padding: 0.7rem 0;
        font-size: 1rem;
        color: var(--text-dark);
        border-bottom: 1px solid var(--border-light);
    }

    .program-card li:last-child {
        border-bottom: none;
    }

    .program-card li i {
        color: var(--primary-green);
        margin-left: 0.8rem;
    }

    /* CTA Section */
    .cta-section {
        background: var(--dark-green);
        padding: 5rem 0;
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .cta-section::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -20%;
        width: 500px;
        height: 500px;
        background: rgba(134, 184, 23, 0.1);
        border-radius: 50%;
    }

    .cta-section::after {
        content: '';
        position: absolute;
        bottom: -50%;
        left: -20%;
        width: 500px;
        height: 500px;
        background: rgba(134, 184, 23, 0.1);
        border-radius: 50%;
    }

    .cta-content {
        position: relative;
        z-index: 1;
    }

    .cta-section h2 {
        font-family: 'Cairo', sans-serif;
        font-size: 2.8rem;
        font-weight: 700;
        color: var(--white);
        margin-bottom: 1.5rem;
    }

    .cta-section .lead {
        font-size: 1.2rem;
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 2.5rem;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
    }

    /* Responsive */
    @media (max-width: 991px) {
        .hero-content {
            flex-direction: column-reverse;
            gap: 3rem;
        }

        .hero-left {
            padding-left: 0;
            text-align: center;
        }

        .hero-title {
            font-size: 2.5rem;
        }

        .hero-description {
            margin-left: auto;
            margin-right: auto;
        }

        .hero-actions {
            justify-content: center;
        }

        .hero-badge {
            display: none;
        }

        .section-title {
            font-size: 2.2rem;
        }

        .cta-section h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 767px) {
        .hero-section {
            min-height: auto;
            padding: 3rem 0;
        }

        .hero-title {
            font-size: 2rem;
        }

        .hero-description {
            font-size: 1rem;
        }

        .hero-actions {
            flex-direction: column;
            width: 100%;
        }

        .hero-actions .btn {
            width: 100%;
        }

        .stat-number {
            font-size: 2.5rem;
        }

        .section-title {
            font-size: 1.8rem;
        }

        .cta-section h2 {
            font-size: 1.8rem;
        }
    }


    .features_section-title {
        font-family: 'Cairo', sans-serif;
        font-size: 2.8rem;
        font-weight: 700;
        color: white;
        margin-bottom: 1rem;
        text-align: center;
    }


    .gallery-section {
        padding: 5rem 0;
    }

    .gallery-slider {
        position: relative;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 3rem;
    }

    .slider-container {
        display: flex;
        overflow-x: auto;
        scroll-behavior: smooth;
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE and Edge */
        gap: 1.5rem;
        padding: 1rem 0;
        scroll-snap-type: x mandatory;
    }

    .slider-container::-webkit-scrollbar {
        display: none; /* Chrome, Safari and Opera */
    }

    .slide-item {
        flex: 0 0 calc(33.333% - 1rem);
        scroll-snap-align: start;
    }

    .photo-card {
        background: var(--white);
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        border: 1px solid var(--border-light);
        height: 350px;
    }

    .photo-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 50px rgba(134, 184, 23, 0.2);
        border-color: var(--primary-green);
    }

    .photo-image {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    .photo-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .photo-card:hover .photo-image img {
        transform: scale(1.05);
    }

    .photo-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to top, rgba(11, 59, 36, 0.9), transparent);
        display: flex;
        align-items: flex-end;
        padding: 2rem;
        opacity: 0;
        transition: all 0.3s ease;
    }

    .photo-card:hover .photo-overlay {
        opacity: 1;
    }

    .photo-info {
        color: var(--white);
        transform: translateY(20px);
        transition: transform 0.3s ease;
    }

    .photo-card:hover .photo-info {
        transform: translateY(0);
    }

    .photo-title {
        font-family: 'Cairo', sans-serif;
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .photo-desc {
        font-size: 0.9rem;
        opacity: 0.9;
        margin-bottom: 1rem;
        line-height: 1.5;
    }

    .album-badge {
        display: inline-block;
        background: var(--primary-green);
        color: var(--white);
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
    }

    /* Slider Navigation */
    .slider-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 50px;
        height: 50px;
        background: var(--white);
        border: 2px solid var(--primary-green);
        border-radius: 50%;
        color: var(--primary-green);
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 10;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .slider-nav:hover {
        background: var(--primary-green);
        color: var(--white);
        transform: translateY(-50%) scale(1.1);
    }

    .slider-nav.prev {
        right: -25px;
    }

    .slider-nav.next {
        left: -25px;
    }

    /* Slider Dots */
    .slider-dots {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 2rem;
    }

    .slider-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--border-light);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .slider-dot.active {
        background: var(--primary-green);
        transform: scale(1.2);
    }

    .empty-gallery {
        padding: 3rem;
        background: var(--white);
        border-radius: 15px;
        border: 2px dashed var(--border-light);
    }

    /* Responsive Design */
    @media (max-width: 991px) {
        .slide-item {
            flex: 0 0 calc(50% - 1rem);
        }

        .gallery-slider {
            padding: 0 2rem;
        }
    }

    @media (max-width: 767px) {
        .slide-item {
            flex: 0 0 calc(100% - 1rem);
        }

        .gallery-slider {
            padding: 0 1rem;
        }

        .slider-nav {
            width: 40px;
            height: 40px;
            font-size: 1rem;
        }

        .slider-nav.prev {
            right: -15px;
        }

        .slider-nav.next {
            left: -15px;
        }

        .photo-card {
            height: 300px;
        }

        .photo-overlay {
            padding: 1.5rem;
        }

        .photo-title {
            font-size: 1.1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section - Split Design -->
<section class="hero-section">
    <div class="container">
        <div class="hero-content">
            <div class="hero-left">
                <span class="hero-tag">منصة التحفيظ والدروس الدينية</span>
                <h1 class="hero-title">
                    رحلة روحانية متكاملة<br>
                    <span class="highlight">لحفظ القرآن الكريم</span>
                </h1>
                <p class="hero-description">
                    نوفر لك تجربة تعليمية شاملة لحفظ القرآن الكريم وتعلم العلوم الشرعية مع أحدث الأساليب التعليمية ومتابعة احترافية لتقدمك المستمر
                </p>
                <div class="hero-actions">
                    {% if not user.is_authenticated %}
                        <a href="{% url 'login' %}" class="btn btn-primary btn-lg">
                            <i class="fas fa-sign-in-alt me-2"></i> تسجيل الدخول
                        </a>
                    {% else %}
                        <a href="{% url 'dashboard' %}" class="btn btn-primary btn-lg">
                            <i class="fas fa-tachometer-alt me-2"></i> لوحة التحكم
                        </a>
                    {% endif %}
                </div>
            </div>

            <div class="hero-right">
                <div class="hero-image-wrapper">
                    <img src="{% static 'images/pexels-tlhaguney-15403114.jpg' %}" alt="منصة التحفيظ" onerror="this.src='https://images.unsplash.com/photo-1542816417-0983c9c9ad53?w=800'">

                    <div class="hero-badge top">
                        <div class="rating-stars">★★★★★</div>
                        <div class="rating-number">9.6</div>
                        <div class="rating-text">تقييم ممتاز</div>
                    </div>

                    <div class="hero-badge bottom">
                        <div class="clients-info">
                            <div class="client-avatars">
                                <div class="client-avatar">أ</div>
                                <div class="client-avatar">م</div>
                                <div class="client-avatar">ح</div>
                            </div>
                            <div class="client-text">طلابنا النشطون</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



<!-- Photo Gallery Slider Section -->
<section class="gallery-section py-5" style="background: var(--light-bg);">
    <div class="container">
        <div class="row mb-5">
            <div class="col-12 text-center">
                <h2 class="section-title">معرض الصور</h2>
                <p class="section-subtitle">
                    لمحات من أنشطتنا وبرامجنا التعليمية
                </p>
            </div>
        </div>

        {% if recent_photos %}
        <div class="row">
            <div class="col-12">
                <!-- Slider Container -->
                <div class="gallery-slider">
                    <div class="slider-container" id="gallerySlider">
                        {% for photo in recent_photos %}
                        <div class="slide-item">
                            <div class="photo-card">
                                <div class="photo-image">
                                    <img src="{{ photo.image.url }}" alt="{{ photo.title }}"
                                         loading="lazy" onerror="this.style.display='none'">
                                    <div class="photo-overlay">
                                        <div class="photo-info">
                                            <h5 class="photo-title">{{ photo.title }}</h5>
                                            {% if photo.description %}
                                            <p class="photo-desc">{{ photo.description|truncatewords:10 }}</p>
                                            {% endif %}
                                            {% if photo.album %}
                                            <span class="album-badge">{{ photo.album.title }}</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <!-- Slider Navigation -->
                    <button class="slider-nav prev" onclick="slidePrev()">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="slider-nav next" onclick="slideNext()">
                        <i class="fas fa-chevron-left"></i>
                    </button>

                    <!-- Slider Dots -->
                    <div class="slider-dots" id="sliderDots"></div>
                </div>
            </div>
        </div>
        {% else %}
        <div class="row">
            <div class="col-12 text-center">
                <div class="empty-gallery">
                    <i class="fas fa-images fa-3x mb-3" style="color: var(--primary-green); opacity: 0.5;"></i>
                    <p class="text-muted">لا توجد صور في المعرض حالياً</p>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- Statistics Section -->
<section class="stats-section">
    <div class="container">
        <div class="row g-4">
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <i class="fas fa-book-open"></i>
                    <div class="stat-number">{{ total_programs }}</div>
                    <div class="stat-label">عدد البرامج</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <i class="fas fa-users"></i>
                    <div class="stat-number">{{ total_committees }}</div>
                    <div class="stat-label">عدد اللجان</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <i class="fas fa-user-graduate"></i>
                    <div class="stat-number">{{ total_students }}</div>
                    <div class="stat-label">عدد الطلاب</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <i class="fas fa-globe"></i>
                    <div class="stat-number">{{ total_users }}</div>
                    <div class="stat-label">إجمالي المستخدمين</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="features-section">
    <div class="container">
        <h2 class="features_section-title" >مميزات المنصة</h2>
        <p class="section-subtitle">
            نقدم لك أفضل الأدوات والخدمات لتسهيل رحلتك التعليمية وتحقيق أهدافك
        </p>
        <div class="row g-4">
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-quran"></i>
                    </div>
                    <h4>تحفيظ القرآن الكريم</h4>
                    <p>
                        نظام متكامل ومتطور لمتابعة حفظ القرآن الكريم مع تقييم دقيق لمستوى الطلاب وتقدمهم المستمر
                    </p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <h4>دروس دينية متخصصة</h4>
                    <p>
                        مجموعة شاملة من الدروس المتنوعة في العلوم الشرعية والفقه والعقيدة بأسلوب تعليمي حديث
                    </p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h4>متابعة التقدم</h4>
                    <p>
                        تقارير تفصيلية وشاملة لمتابعة تقدم الطلاب وإنجازاتهم مع إحصائيات دقيقة وتحليلات متقدمة
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Programs Section -->
<section class="programs-section">
    <div class="container">
        <h2 class="section-title">برامجنا التعليمية</h2>
        <p class="section-subtitle">
            برامج متكاملة مصممة خصيصاً لتلبية احتياجاتك التعليمية والروحانية
        </p>
        <div class="row g-4">
            <div class="col-lg-6">
                <div class="program-card">
                    <h4>برنامج تحفيظ القرآن الكريم</h4>
                    <p>
                        برنامج شامل ومتكامل لحفظ القرآن الكريم مع متابعة دقيقة للتلاوة والتجويد وتطبيق أحكام التجويد بإتقان
                    </p>
                    <ul>
                        <li><i class="fas fa-check"></i> حفظ الأجزاء والأرباع بإتقان</li>
                        <li><i class="fas fa-check"></i> متابعة يومية للتلاوة والمراجعة</li>
                        <li><i class="fas fa-check"></i> اختبارات دورية وتقييم مستمر</li>
                        <li><i class="fas fa-check"></i> تصحيح الأخطاء وتحسين الأداء</li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="program-card">
                    <h4>برنامج الدروس الشرعية</h4>
                    <p>
                        دروس متخصصة وعميقة في الفقه والعقيدة والسيرة النبوية والحديث الشريف بمنهجية علمية رصينة
                    </p>
                    <ul>
                        <li><i class="fas fa-check"></i> فقه العبادات والمعاملات</li>
                        <li><i class="fas fa-check"></i> العقيدة الإسلامية الصحيحة</li>
                        <li><i class="fas fa-check"></i> السيرة النبوية الشريفة</li>
                        <li><i class="fas fa-check"></i> دراسة الحديث النبوي الشريف</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section">
    <div class="container cta-content">
        <h2>انضم إلى مجتمعنا التعليمي الآن</h2>
        <p class="lead">
            ابدأ رحلتك الروحانية في حفظ القرآن الكريم وتعلم العلوم الشرعية مع منصتنا المتكاملة والاحترافية
        </p>
        {% if not user.is_authenticated %}
            <a href="{% url 'login' %}" class="btn btn-outline-light btn-lg">
                <i class="fas fa-sign-in-alt me-2"></i> ابدأ الآن
            </a>
        {% else %}
            <a href="{% url 'dashboard' %}" class="btn btn-outline-light btn-lg">
                <i class="fas fa-tachometer-alt me-2"></i> الانتقال للوحة التحكم
            </a>
        {% endif %}
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
    // Intersection Observer for animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Observe all cards
    document.querySelectorAll('.feature-card, .program-card, .stat-card').forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'all 0.6s ease-out';
        observer.observe(card);
    });

    // Counter animation for statistics
    const animateCounter = (element, target, duration = 2000) => {
        let start = 0;
        const increment = target / (duration / 16);

        const timer = setInterval(() => {
            start += increment;
            if (start >= target) {
                element.textContent = target;
                clearInterval(timer);
            } else {
                element.textContent = Math.floor(start);
            }
        }, 16);
    };

    // Trigger counter animation when stats section is visible
    const statsObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                document.querySelectorAll('.stat-number').forEach(stat => {
                    const target = parseInt(stat.textContent);
                    stat.textContent = '0';
                    animateCounter(stat, target);
                });
                statsObserver.unobserve(entry.target);
            }
        });
    }, { threshold: 0.5 });

    const statsSection = document.querySelector('.stats-section');
    if (statsSection) {
        statsObserver.observe(statsSection);
    }


    // Gallery Slider Functionality
    let currentSlide = 0;
    let slidesPerView = 3;
    let totalSlides = {{ recent_photos|length }};

    // Update slides per view based on screen size
    function updateSlidesPerView() {
        if (window.innerWidth < 768) {
            slidesPerView = 1;
        } else if (window.innerWidth < 992) {
            slidesPerView = 2;
        } else {
            slidesPerView = 3;
        }
        updateSlider();
    }

    // Initialize slider
    function initSlider() {
        updateSlidesPerView();
        createDots();
        updateSlider();
    }

    // Create dots indicator
    function createDots() {
        const dotsContainer = document.getElementById('sliderDots');
        dotsContainer.innerHTML = '';

        const totalDots = Math.ceil(totalSlides / slidesPerView);

        for (let i = 0; i < totalDots; i++) {
            const dot = document.createElement('div');
            dot.className = 'slider-dot' + (i === 0 ? ' active' : '');
            dot.onclick = () => goToSlide(i);
            dotsContainer.appendChild(dot);
        }
    }

    // Go to specific slide
    function goToSlide(slideIndex) {
        currentSlide = slideIndex;
        updateSlider();
    }

    // Update slider position
    function updateSlider() {
        const slider = document.getElementById('gallerySlider');
        const slideWidth = 100 / slidesPerView;
        const translateX = -currentSlide * slideWidth;

        slider.style.transform = `translateX(${translateX}%)`;

        // Update dots
        const dots = document.querySelectorAll('.slider-dot');
        dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentSlide);
        });
    }

    // Next slide
    function slideNext() {
        const maxSlide = Math.ceil(totalSlides / slidesPerView) - 1;
        currentSlide = currentSlide >= maxSlide ? 0 : currentSlide + 1;
        updateSlider();
    }

    // Previous slide
    function slidePrev() {
        const maxSlide = Math.ceil(totalSlides / slidesPerView) - 1;
        currentSlide = currentSlide <= 0 ? maxSlide : currentSlide - 1;
        updateSlider();
    }

    // Auto slide (optional)
    let autoSlideInterval;

    function startAutoSlide() {
        autoSlideInterval = setInterval(slideNext, 5000);
    }

    function stopAutoSlide() {
        clearInterval(autoSlideInterval);
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        if (totalSlides > 0) {
            initSlider();
            startAutoSlide();

            // Pause auto slide on hover
            const slider = document.querySelector('.gallery-slider');
            slider.addEventListener('mouseenter', stopAutoSlide);
            slider.addEventListener('mouseleave', startAutoSlide);
        }
    });

    // Update on window resize
    window.addEventListener('resize', function() {
        updateSlidesPerView();
    });

    // Also add this to your existing counter animation code
    // Make sure it's included in the existing extra_js block
</script>
{% endblock %}